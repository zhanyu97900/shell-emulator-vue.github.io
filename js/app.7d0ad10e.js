(function(){"use strict";var t={7167:function(t,n,e){var o=e(9242),r=e(3396);function i(t,n,e,o,i,s){const u=(0,r.up)("ShellContainer"),c=(0,r.up)("SoftKeyBoard");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(u),i.isMobile?((0,r.wg)(),(0,r.j4)(c,{key:0})):(0,r.kq)("",!0)],64)}function s(t,n,e,o,i,s){const u=(0,r.up)("HistoryLines"),c=(0,r.up)("InputLine");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(u,{"history-content":i.historyContent},null,8,["history-content"]),(0,r.Wm)(c,{"current-dir":i.currentDir,onFinishedInput:s.onFinishedInput,onInterruptInput:s.onInterruptInput,onReInput:s.onReInput},null,8,["current-dir","onFinishedInput","onInterruptInput","onReInput"])],64)}const u=["innerHTML"];function c(t,n,e,o,i,s){return(0,r.wg)(),(0,r.iD)("span",{class:"history-content",innerHTML:e.historyContent},null,8,u)}var l={name:"HistoryLines",props:["historyContent"]},a=e(89);const h=(0,a.Z)(l,[["render",c],["__scopeId","data-v-13a5d1fb"]]);var d=h,f=e(7139);const p={class:"input-line",id:"input-line"},m={class:"shell-prompt"},y={class:"hint-area"};function g(t,n,e,o,i,s){return(0,r.wg)(),(0,r.iD)("div",p,[(0,r._)("span",m,(0,f.zw)(s.getShellPrompt()),1),(0,r._)("span",{class:"input-area",ref:"inputArea",contenteditable:"true",onInput:n[0]||(n[0]=(...t)=>s.onInput&&s.onInput(...t))},null,544),(0,r._)("span",y,(0,f.zw)(i.displayHint),1)])}e(560);var v=e(4003);const C=window.externalCommand,w={checkDesktop:e(3557).Z,directoryHint:e(8760).Z,eventBus:e(4003).Z,fileSystem:e(8059),getAbsolutePath:e(5438).Z,getHomeDir:e(4157).Z,initUptime:e(6835).Z};function Z(t,n){const e=n.split(" ").map((t=>t.trim())).filter((t=>t.length>0)),o=e[0];if(null===o||void 0===o||0===o.length)return;const r=e.slice(1);for(const i of C)if(i.name===o)return i.func(t,r,w);return`${o}: command not found`}function H(t,n){const e=n.split(" ").map((t=>t.trim())).filter((t=>t.length>0)),o=e[0];if(null===o||void 0===o||0===o.length)return[];if(n.endsWith(" ")||n.endsWith("Â "))return[];for(const i of C)if(i.name===o)return i.hint?.(t,e.slice(1),w)??[];if(e.length>1)return[];let r=[];for(const i of C)i.name.startsWith(o)&&r.push(i.name.slice(o.length));return r.sort(((t,n)=>t.length!==n.length?t.length-n.length:t.localeCompare(n))),r}var I=e(4157),k={name:"InputLine",props:["currentDir"],data(){return{promptUser:window.config.username,promptHost:window.config.hostname,currentCommand:"",currentHint:[],displayHint:"",hintTabCount:0,historyCommands:[],curHistoryIndex:0}},methods:{getFocus(){document.activeElement!==this.$refs.inputArea&&(this.$refs.inputArea.focus(),this.moveCursorToEnd())},moveCursorToEnd(){if(document.activeElement!==this.$refs.inputArea)return;const t=this.$refs.inputArea,n=document.createRange(),e=window.getSelection();n.selectNodeContents(t),n.collapse(!1),e.removeAllRanges(),e.addRange(n)},getShellPrompt(){let t="";if(this.currentDir===(0,I.Z)())t="~";else{const n=this.currentDir.split("/").pop();t=n.length>0?n:"/"}return window.config.prompt.replace(/{user}/g,this.promptUser).replace(/{host}/g,this.promptHost).replace(/{cwd}/g,t)},updateCurrentCommand(t){this.currentCommand=t,this.$refs.inputArea.innerText=t},onInput(){this.currentCommand=this.$refs.inputArea.innerText,this.curHistoryIndex=this.historyCommands.length,this.updateHint()},updateHint(){if(this.hintTabCount=0,this.currentHint=[],this.displayHint="",0===this.currentCommand.length)return;const t=H(this.currentDir,this.currentCommand);0!==t.length&&(this.displayHint=t.at(0));for(let n=0;n<t.length;n++){const e=this.currentCommand.split(" ");t[n]=e[e.length-1]+t[n]}this.currentHint=t},confirmHint(){if(0===this.currentHint.length);else if(1===this.currentHint.length)this.updateCurrentCommand(this.currentCommand+this.displayHint),this.updateHint(),this.moveCursorToEnd();else if(0===this.hintTabCount)this.hintTabCount++;else{const t=this.currentHint;for(let n=0;n<t.length;n++){const e=t[n].split("/");t[n]=e[e.length-1]}this.$emit("re-input",this.getShellPrompt(),this.escapeHtml(this.currentCommand),t.join("\t\t"))}},finishedInput(){this.$emit("finished-input",this.getShellPrompt(),this.escapeHtml(this.currentCommand)),this.historyCommands.push(this.currentCommand),this.curHistoryIndex=this.historyCommands.length,this.updateCurrentCommand(""),this.updateHint()},interruptInput(){this.$emit("interrupt-input",this.getShellPrompt(),this.escapeHtml(this.currentCommand)),this.updateCurrentCommand(""),this.updateHint()},onPrevHistory(){this.curHistoryIndex>0&&(this.curHistoryIndex--,this.updateCurrentCommand(this.historyCommands[this.curHistoryIndex])),this.moveCursorToEnd(),this.updateHint()},onNextHistory(){this.curHistoryIndex<this.historyCommands.length-1?(this.curHistoryIndex++,this.updateCurrentCommand(this.historyCommands[this.curHistoryIndex])):(this.curHistoryIndex=this.historyCommands.length,this.updateCurrentCommand("")),this.moveCursorToEnd(),this.updateHint()},escapeHtml(t){const n={"<":"&lt;",">":"&gt;"};return t.replace(/[<>]/g,(function(t){return n[t]}))}},mounted(){v.Z.on("touch",this.getFocus),v.Z.on("key-down",this.getFocus),v.Z.on("ctrl-c",this.interruptInput),v.Z.on("enter",this.finishedInput),v.Z.on("arrow-up",this.onPrevHistory),v.Z.on("arrow-down",this.onNextHistory),v.Z.on("tab",this.confirmHint)},unmounted(){v.Z.off("touch",this.getFocus),v.Z.off("key-down",this.getFocus),v.Z.off("ctrl-c",this.interruptInput),v.Z.off("enter",this.finishedInput),v.Z.off("arrow-up",this.onPrevHistory),v.Z.off("arrow-down",this.onNextHistory),v.Z.off("tab",this.confirmHint)}};const b=(0,a.Z)(k,[["render",g],["__scopeId","data-v-cd2154a6"]]);var D=b,S={name:"ShellContainer",components:{HistoryLines:d,InputLine:D},data(){return{historyContent:window.config.initialContent,currentDir:(0,I.Z)()}},methods:{onClear(){this.historyContent=""},onFinishedInput(t,n){this.historyContent+=`${t}${n}\n`;const e=Z(this.currentDir,n);void 0!==e&&null!==e&&e.length>0&&(this.historyContent+=`${e}\n`),this.$nextTick((()=>{document.querySelector("#input-line").scrollIntoView()}))},onInterruptInput(t,n){this.historyContent+=`${t}${n}^C\n`,this.$nextTick((()=>{document.querySelector("#input-line").scrollIntoView()}))},onReInput(t,n,e){this.historyContent+=`${t}${n}\n`,this.historyContent+=`${e}\n`,this.$nextTick((()=>{document.querySelector("#input-line").scrollIntoView()}))},onChangeDir(t){this.currentDir=t}},mounted(){v.Z.on("ctrl-l",this.onClear),v.Z.on("change-dir",this.onChangeDir)},beforeUnmount(){v.Z.off("ctrl-l",this.onClear),v.Z.off("change-dir",this.onChangeDir)}};const T=(0,a.Z)(S,[["render",s]]);var _=T;const x=t=>((0,r.dD)("data-v-16697e84"),t=t(),(0,r.Cn)(),t),A=x((()=>(0,r._)("div",{class:"padding"},null,-1))),P={class:"keyboard"},$=x((()=>(0,r._)("div",{class:"div"},null,-1))),O=x((()=>(0,r._)("div",{class:"div"},null,-1))),E=x((()=>(0,r._)("div",{class:"div"},null,-1))),L=x((()=>(0,r._)("div",{class:"div"},null,-1)));function j(t,n,e,o,i,s){return(0,r.wg)(),(0,r.iD)(r.HY,null,[A,(0,r._)("div",P,[(0,r._)("div",{class:"key",onClick:n[0]||(n[0]=(...t)=>s.onTab&&s.onTab(...t))},"TAB"),$,(0,r._)("div",{class:"key",onClick:n[1]||(n[1]=(...t)=>s.onEnter&&s.onEnter(...t))},"Enter"),O,(0,r._)("div",{class:"key",onClick:n[2]||(n[2]=(...t)=>s.onCtrlC&&s.onCtrlC(...t))},"Ctrl-C"),E,(0,r._)("div",{class:"key",onClick:n[3]||(n[3]=(...t)=>s.onArrowUp&&s.onArrowUp(...t))},"UP"),L,(0,r._)("div",{class:"key",onClick:n[4]||(n[4]=(...t)=>s.onArrowDown&&s.onArrowDown(...t))},"DOWN")])],64)}var F={name:"SoftKeyBoard",methods:{onTab(t){t.stopPropagation(),v.Z.emit("tab")},onEnter(t){t.stopPropagation(),v.Z.emit("enter")},onCtrlC(t){t.stopPropagation(),v.Z.emit("ctrl-c")},onArrowUp(t){t.stopPropagation(),v.Z.emit("arrow-up")},onArrowDown(t){t.stopPropagation(),v.Z.emit("arrow-down")}}};const W=(0,a.Z)(F,[["render",j],["__scopeId","data-v-16697e84"]]);var U=W,K=e(6835),M=e(3557),B={name:"App",components:{ShellContainer:_,SoftKeyBoard:U},methods:{onKeyDown(t){v.Z.emit("key-down"),"Enter"===t.key?(t?.preventDefault(),v.Z.emit("enter")):"c"===t.key.toLowerCase()&&t.ctrlKey?(t?.preventDefault(),v.Z.emit("ctrl-c")):"l"===t.key.toLowerCase()&&t.ctrlKey?(t?.preventDefault(),v.Z.emit("ctrl-l")):"ArrowUp"===t.key?(t?.preventDefault(),v.Z.emit("arrow-up")):"ArrowDown"===t.key?(t?.preventDefault(),v.Z.emit("arrow-down")):"Tab"===t.key&&(t?.preventDefault(),v.Z.emit("tab"))},onClick(t){(0,M.Z)()||v.Z.emit("touch")}},data(){return{isMobile:!(0,M.Z)()}},mounted(){document.addEventListener("keydown",this.onKeyDown),document.addEventListener("click",this.onClick),(0,K.Z)()},beforeUnmount(){document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("click",this.onClick)}};const R=(0,a.Z)(B,[["render",i]]);var N=R;(0,o.ri)(N).mount("#app")},3557:function(t,n,e){function o(){const t=/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent),n=/iPad/i.test(navigator.userAgent),e=!t&&!n;return e}e.d(n,{Z:function(){return o}})},8760:function(t,n,e){e.d(n,{Z:function(){return i}});e(560);var o=e(8059),r=e(5438);function i(t,n){let e=(0,r.Z)(t,n?.trim());n?.endsWith("/")&&!e.endsWith("/")&&(e+="/");const i=e.lastIndexOf("/"),s=e.slice(0,i),u=e.slice(i+1),c=(0,o.listDirectory)(s);if(null===c)return[];const l=[],a=[];for(const o of c)o.startsWith(u)&&(o.startsWith(".")?a.push(o.slice(u.length)):l.push(o.slice(u.length)));return l.concat(a)}},4003:function(t,n,e){var o=e(1373);const r=(0,o.Z)();n.Z=r},8059:function(t,n,e){e.r(n),e.d(n,{checkDirectory:function(){return i},checkFile:function(){return c},getFileContent:function(){return r},listDirectory:function(){return s},listDirectoryWithTypes:function(){return u}});e(560);const o=window.fsTree;function r(t){const n=t.split("/").map((t=>t.trim())).filter((t=>t.length>0));let e=o;for(const o of n){if(void 0===e[o])return null;e=e[o]}return"function"!==typeof e?null:e()}function i(t){const n=t.split("/").map((t=>t.trim())).filter((t=>t.length>0));let e=o;for(const o of n){if(void 0===e[o])return!1;e=e[o]}return"function"!==typeof e}function s(t){const n=t.split("/").map((t=>t.trim())).filter((t=>t.length>0));let e=o;for(const o of n){if(void 0===e[o])return null;e=e[o]}return"function"===typeof e?null:Object.keys(e).sort()}function u(t){const n=t.split("/").map((t=>t.trim())).filter((t=>t.length>0));let e=o;for(const o of n){if(void 0===e[o])return null;e=e[o]}if("function"===typeof e)return null;const r=[];for(const o of Object.keys(e).sort())r.push(["function"===typeof e[o]?"f":"d",o]);return r}function c(t){const n=t.split("/").map((t=>t.trim())).filter((t=>t.length>0));let e=o;for(const o of n){if(void 0===e[o])return!1;e=e[o]}return"function"===typeof e}},5438:function(t,n,e){e.d(n,{Z:function(){return s}});var o=e(6554),r=e.n(o),i=e(4157);function s(t,n){let e="";return e=void 0===n||null===n||0===n.length?(0,i.Z)():"~"===n[0]?r().resolve((0,i.Z)()+n.slice(1)):r().resolve(t,n),e}},4157:function(t,n,e){function o(){return"root"===window.config.username?"/root":"/home/"+window.config.username}e.d(n,{Z:function(){return o}})},6835:function(t,n,e){function o(){null!==localStorage.getItem("uptime")&&void 0!==localStorage.getItem("uptime")?Date.now()-localStorage.getItem("uptime")>window.config.uptimeLimitMS&&localStorage.setItem("uptime",Date.now()):localStorage.setItem("uptime",Date.now())}e.d(n,{Z:function(){return o}})}},n={};function e(o){var r=n[o];if(void 0!==r)return r.exports;var i=n[o]={exports:{}};return t[o].call(i.exports,i,i.exports,e),i.exports}e.m=t,function(){var t=[];e.O=function(n,o,r,i){if(!o){var s=1/0;for(a=0;a<t.length;a++){o=t[a][0],r=t[a][1],i=t[a][2];for(var u=!0,c=0;c<o.length;c++)(!1&i||s>=i)&&Object.keys(e.O).every((function(t){return e.O[t](o[c])}))?o.splice(c--,1):(u=!1,i<s&&(s=i));if(u){t.splice(a--,1);var l=r();void 0!==l&&(n=l)}}return n}i=i||0;for(var a=t.length;a>0&&t[a-1][2]>i;a--)t[a]=t[a-1];t[a]=[o,r,i]}}(),function(){e.n=function(t){var n=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(n,{a:n}),n}}(),function(){e.d=function(t,n){for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})}}(),function(){e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)}}(),function(){e.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={143:0};e.O.j=function(n){return 0===t[n]};var n=function(n,o){var r,i,s=o[0],u=o[1],c=o[2],l=0;if(s.some((function(n){return 0!==t[n]}))){for(r in u)e.o(u,r)&&(e.m[r]=u[r]);if(c)var a=c(e)}for(n&&n(o);l<s.length;l++)i=s[l],e.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return e.O(a)},o=self["webpackChunkshell_emulator"]=self["webpackChunkshell_emulator"]||[];o.forEach(n.bind(null,0)),o.push=n.bind(null,o.push.bind(o))}();var o=e.O(void 0,[998],(function(){return e(7167)}));o=e.O(o)})();
//# sourceMappingURL=app.7d0ad10e.js.map